# AskChatGpt

**AskChatGpt** is a class that inherits from **BaseOperator** and provides a way to ask GPT a question with an optional context, along with the maximum tokens for the response. The main functionality is contained within the `run_step` method.

## Declare Parameters

The class declares the following parameters:

- question (string): The question to be asked.
- context (string, optional): The context for the question, if needed.
- max_tokens (integer): The maximum number of tokens allowed for the answer.

## Declare Inputs

The class declares the following input:

- context (string, optional): A separate context that can be provided when the step is executed, in addition to the context parameter.

## Declare Outputs

The class declares the following output:

- chatgpt_response (string): The response generated by ChatGPT.

## Run Step

The `run_step` method is responsible for generating the ChatGPT response. It processes the context input and parameters and formats the prompt before sending it to the ChatGPT. The generated response is then set as the output `chatgpt_response`.

1. First, it retrieves the parameters with:
   ```
   p = step['parameters']
   ```

2. Next, the input context is fetched with:
   ```
   input_context = ai_context.get_input('context', self)
   prompt = p['question']
   param_context = p.get('context')
   ```

3. The method then generates a complete context by checking the input context and parameter context, and concatenates them if they both exist, or simply uses one or none, depending on their availability.

4. If a context exists, the prompt is updated to include the context:
   ```
   prompt = f'Given the context: {context}, answer the question or complete the following task: {prompt}'
   ```

5. The prompt is then sent to ChatGPT to generate a response:
   ```
   ai_response = ai_context.run_chat_completion(prompt=prompt)
   ```

6. The generated response is set as the output `chatgpt_response` and is added to the execution log:
   ```
   ai_context.set_output('chatgpt_response', ai_response, self)
   ai_context.add_to_log(f'Response from ChatGPT: {ai_response}', save=True)
   ```